{
  "entities": {
    "StoreConfig": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "StoreConfig",
      "type": "object",
      "description": "Represents the store's configuration settings.",
      "properties": {
        "storeName": {
          "type": "string",
          "description": "The name of the store."
        },
        "cnpj": {
          "type": "string",
          "description": "The CNPJ of the store."
        },
        "address": {
          "type": "string",
          "description": "The physical address of the store."
        },
        "phone": {
          "type": "string",
          "description": "The contact phone number for the store."
        }
      },
      "required": [
        "storeName"
      ]
    },
    "Part": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Part",
      "type": "object",
      "description": "Represents an auto part in the inventory.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the part."
        },
        "name": {
          "type": "string",
          "description": "Name of the part."
        },
        "description": {
          "type": "string",
          "description": "Detailed description of the part."
        },
        "purchasePrice": {
          "type": "number",
          "description": "The price at which the part was purchased."
        },
        "salePrice": {
          "type": "number",
          "description": "The price at which the part is sold."
        },
        "quantity": {
          "type": "number",
          "description": "Current quantity of the part in inventory."
        },
        "createdAt": {
          "type": "string",
          "description": "Timestamp of when the part was added to the inventory.",
          "format": "date-time"
        },
        "updatedAt": {
          "type": "string",
          "description": "Timestamp of when the part was last updated.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "name",
        "purchasePrice",
        "salePrice",
        "quantity"
      ]
    },
    "Employee": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Employee",
      "type": "object",
      "description": "Represents an employee of the auto parts store.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the employee."
        },
        "employeeCode": {
          "type": "string",
          "description": "Unique, auto-generated code for the employee."
        },
        "firstName": {
          "type": "string",
          "description": "First name of the employee."
        },
        "lastName": {
          "type": "string",
          "description": "Last name of the employee."
        },
        "email": {
          "type": "string",
          "description": "Email address of the employee.",
          "format": "email"
        },
        "phoneNumber": {
          "type": "string",
          "description": "Phone number of the employee."
        },
        "role": {
          "type": "string",
          "description": "Role of the employee (e.g., manager, sales representative)."
        },
        "createdAt": {
          "type": "string",
          "description": "Timestamp of when the employee was added.",
          "format": "date-time"
        },
        "updatedAt": {
          "type": "string",
          "description": "Timestamp of when the employee was last updated.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "employeeCode",
        "firstName",
        "lastName",
        "email",
        "role"
      ]
    },
    "Customer": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Customer",
      "type": "object",
      "description": "Represents a customer of the auto parts store.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the customer."
        },
        "firstName": {
          "type": "string",
          "description": "First name of the customer."
        },
        "lastName": {
          "type": "string",
          "description": "Last name of the customer."
        },
        "email": {
          "type": "string",
          "description": "Email address of the customer.",
          "format": "email"
        },
        "phoneNumber": {
          "type": "string",
          "description": "Phone number of the customer."
        },
        "address": {
          "type": "string",
          "description": "Address of the customer."
        },
        "createdAt": {
          "type": "string",
          "description": "Timestamp of when the customer was added.",
          "format": "date-time"
        },
        "updatedAt": {
          "type": "string",
          "description": "Timestamp of when the customer was last updated.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "firstName",
        "lastName",
        "email"
      ]
    },
    "Sale": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Sale",
      "type": "object",
      "description": "Represents a sale transaction.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the sale."
        },
        "customerId": {
          "type": "string",
          "description": "Reference to Customer. (Relationship: Customer 1:N Sale)"
        },
        "employeeId": {
          "type": "string",
          "description": "Reference to Employee. (Relationship: Employee 1:N Sale)"
        },
        "saleDate": {
          "type": "string",
          "description": "Date of the sale.",
          "format": "date-time"
        },
        "totalAmount": {
          "type": "number",
          "description": "Total amount of the sale."
        },
        "createdAt": {
          "type": "string",
          "description": "Timestamp of when the Sale was added.",
          "format": "date-time"
        },
        "updatedAt": {
          "type": "string",
          "description": "Timestamp of when the Sale was last updated.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "customerId",
        "employeeId",
        "saleDate",
        "totalAmount"
      ]
    },
    "SaleItem": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "SaleItem",
      "type": "object",
      "description": "Represents an item within a sale transaction.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the sale item."
        },
        "saleId": {
          "type": "string",
          "description": "Reference to Sale. (Relationship: Sale 1:N SaleItem)"
        },
        "partId": {
          "type": "string",
          "description": "Reference to Part. (Relationship: Part 1:N SaleItem)"
        },
        "quantity": {
          "type": "number",
          "description": "Quantity of the part sold in this sale item."
        },
        "unitPrice": {
          "type": "number",
          "description": "Price of a single unit of the part at the time of the sale."
        },
        "createdAt": {
          "type": "string",
          "description": "Timestamp of when the SaleItem was added.",
          "format": "date-time"
        },
        "updatedAt": {
          "type": "string",
          "description": "Timestamp of when the SaleItem was last updated.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "saleId",
        "partId",
        "quantity",
        "unitPrice"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/storeConfig/main",
        "definition": {
          "entityName": "StoreConfig",
          "schema": {
            "$ref": "#/backend/entities/StoreConfig"
          },
          "description": "Stores the main configuration for the store."
        }
      },
      {
        "path": "/parts/{partId}",
        "definition": {
          "entityName": "Part",
          "schema": {
            "$ref": "#/backend/entities/Part"
          },
          "description": "Stores auto part information.",
          "params": [
            {
              "name": "partId",
              "description": "The unique identifier for the part."
            }
          ]
        }
      },
      {
        "path": "/employees/{employeeId}",
        "definition": {
          "entityName": "Employee",
          "schema": {
            "$ref": "#/backend/entities/Employee"
          },
          "description": "Stores employee information.",
          "params": [
            {
              "name": "employeeId",
              "description": "The unique identifier for the employee."
            }
          ]
        }
      },
      {
        "path": "/customers/{customerId}",
        "definition": {
          "entityName": "Customer",
          "schema": {
            "$ref": "#/backend/entities/Customer"
          },
          "description": "Stores customer information.",
          "params": [
            {
              "name": "customerId",
              "description": "The unique identifier for the customer."
            }
          ]
        }
      },
      {
        "path": "/sales/{saleId}",
        "definition": {
          "entityName": "Sale",
          "schema": {
            "$ref": "#/backend/entities/Sale"
          },
          "description": "Stores sale transaction information.  References customerId and employeeId.",
          "params": [
            {
              "name": "saleId",
              "description": "The unique identifier for the sale."
            }
          ]
        }
      },
      {
        "path": "/sales/{saleId}/saleItems/{saleItemId}",
        "definition": {
          "entityName": "SaleItem",
          "schema": {
            "$ref": "#/backend/entities/SaleItem"
          },
          "description": "Stores items within a sale transaction. References saleId and partId.",
          "params": [
            {
              "name": "saleId",
              "description": "The unique identifier for the sale."
            },
            {
              "name": "saleItemId",
              "description": "The unique identifier for the sale item."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore data structure is designed to efficiently store and manage data for the AutoParts Manager application. It focuses on clarity, scalability, and security, adhering to the principles of Authorization Independence and Structural Segregation.  Each entity (Part, Employee, Customer, Sale, SaleItem, and StoreConfig) has its own dedicated collection.  Path-based ownership is employed where applicable to simplify security rules.  \n\nStore configuration is stored in a singleton document `/storeConfig/main` for easy access.\n\nParts are stored in a top-level `parts` collection. Employees and Customers are similarly stored in `employees` and `customers` collections respectively.\n\nSales are organized under the `sales` collection. Each sale has a `customerId` and `employeeId` to link back to the respective entities. SaleItems are stored as subcollections under each `sale` document, ensuring data locality and efficient querying of items within a specific sale. Relationships are modeled via document references.\n\n**Authorization Independence:** No `get()` calls are required in security rules, as authorization depends solely on `request.auth.uid` and the roles of the authenticated user, which is managed separately. \n\n**QAPs (Rules are not Filters):** The structure facilitates secure list operations by segregating data based on entity type and relationships. This prevents the need for complex filtering in security rules and ensures that only authorized data is accessed."
  }
}